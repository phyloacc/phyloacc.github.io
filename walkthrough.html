
<!doctype html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='shortcut icon' href='img/favicon.ico' type='image/x-icon'/ >
    <link type="text/css" rel="stylesheet" href="css/grid.css"  media="screen,projection" />
    <link type="text/css" rel="stylesheet" href="css/global.css"  media="screen,projection" />
    <link type="text/css" rel="stylesheet" href="css/file.css"  media="screen,projection" />
    <title>PhyloAcc - Walkthrough</title>
</head>

<body>
    <div class="row" id="desktop-nav">
    <div class="col-3-24" id="margin"></div>
    <div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="index.html">PhyloAcc</a></div>
    <div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="install.html">Install</a></div>
    <div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="readme.html">README</a></div>
    <div class="col-3-24" id="nav-link-cell"><a class="nav-link" id="active" href="#">Walkthrough</a></div>
    <div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="https://github.com/phyloacc/PhyloAcc">Github</a></div>
    <div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="links.html">Links</a></div>

    <div class="col-3-24" id="margin"></div>
</div>

<div class="row" id="mobile_nav">
    <div class="col-24-24 dropdown" id="nav_link_cell">
        <a href="#" class="nav_link"><img id="mobile_logo_nav" src="img/nav.png"></a> <span id="nav-text">Navigation</span>
        <div class="dropdown_container mobile_drop">
            <ul class="dropdown_list">
                <li class="dropdown_list_item"><a href="index.html" id="mobile_nav_link">PhyloAcc</a></li>
                <li class="dropdown_list_item"><a href="install.html" id="mobile_nav_link">Install</a></li>
                <li class="dropdown_list_item"><a href="readme.html" id="mobile_nav_link">README</a></li>
                <li class="dropdown_list_item"><a href="#" id="mobile_nav_link">Walkthrough</a></li>
                <li class="dropdown_list_item"><a href="https://github.com/phyloacc/PhyloAcc" id="mobile_nav_link">Github</a></li>
                <li class="dropdown_list_item"><a href="links.html" id="mobile_nav_link">Links</a></li>
            </ul>
        </div>
    </div>  
</div>
    
<a class="internal-link" name="install"></a>
    <div class="row" id="body-row">
        <div class="col-4-24" id="side-nav-cont">
            <div id="side-nav">
                <span id="side-header">Coming soon!</span>
                
                <!--
                <ul>
                    <li><a href="readme.html#install">Installation</a></li>
                    <li><a href="readme.html#inputs">Inputs</a></li>
                    <li><a href="readme.html#usage">Usage</a></li>
                    <ol>
                        <li><a href="readme.html#st">Species tree model</a></li>
                        <li><a href="readme.html#gt">Gene tree model</a></li>
                        <li><a href="readme.html#adaptive">Adaptive model</a></li>
                        <li><a href="readme.html#snakemake">Executing snakemake</a></li>
                        <li><a href="readme.html#gather">Gather outputs</a></li>
                    </ol>
                    <li><a href="readme.html#output">Output</a></li>
                    <ol>
                        <li><a href="readme.html#elem_lik">elem_lik.txt</a></li>
                        <li><a href="readme.html#id-key">id_key.txt</a></li>
                        <li><a href="readme.html#elem_z">elem_z.txt</a></li>
                        <li><a href="readme.html#rate_postZ">rate_postZ_M*.txt</a></li>
                    </ol>
                    <li><a href="readme.html#options">Options</a></li>
                    <ol>
                        <li><a href="readme.html#io">Input/output</a></li>
                        <li><a href="readme.html#mcmc">MCMC</a></li>
                        <li><a href="readme.html#scf">sCF</a></li>
                        <li><a href="readme.html#batch">Batching</a></li>
                        <li><a href="readme.html#cluster">Cluster</a></li>
                        <li><a href="readme.html#phyloacc">PhyloAcc</a></li>
                        <li><a href="readme.html#misc">Miscellaneous</a></li>
                    </ol>
                </ul>
                -->

            </div>
        </div>

        <div class="col-20-24" id="main-content-col-page">

            <div class="row" id="top-row-cont">
                <div class="col-24-24" id="top-row"></div>
            </div>

            <div class="header">
                PhyloAcc Walkthrough
            </div>

            <center>
                <h3>Here we try to provide some step-by-step instructions on how to predict accelerated substitution rates from genomic data</h3>
                We will guide you through the process of obtaining the inputs needed to run PhyloAcc, running PhyloAcc, and interpreting the output.
                Some of the steps have been automated in the <a href="https://github.com/phyloacc/phyloacc-workflows" target="_blank">PhyloAcc workflows</a> repository.

                <b>This is still a work in progress.</b>
            </center>
            

           
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Introduction</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">


                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            
            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Species tree topology</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">

                            <p>
                                PhyloAcc requires a species tree to be provided as input. This tree should be in Newick format, and should contain branch lengths in terms relative number of substitutions for <b>neutral sites</b> (see below).
                            </p>

                            <h2>Inferring the species tree topology</h2>

                            <p>
                                There are many tools and guides available for inferring species trees from genomic data. Basically, you need to align orthologous sequences from each species, and then use a tool to infer the species tree topology from the alignments. Starting from
                                the whole genome FASTA files and their annotations (.gtf or .gff files), one can predict orthology, extract and align loci, and infer locus and species trees. This is commonly done using protein coding genes (CDS) or ultraconserved elements (UCEs).
                            </p>

                            <p>
                                There are many ways to infer the species tree, and the exact method you choose will depend on the loci and methods available to you. Here is a brief outline of one possible approach using genes:
                            </p>

                            <ol>
                                <li>
                                    Download the whole genome FASTA files and their annotations (.gtf or .gff files) for each species. You can get these from public databases such as 
                                    <a href="https://www.ncbi.nlm.nih.gov/genome/" target="_blank">NCBI</a>, <a href="https://genome.ucsc.edu/" target="_blank">UCSC</a>, or <a href="https://useast.ensembl.org/index.html" target="_blank">Ensembl</a>, but you may also be able to find them
                                    in a paper's supplement or you may have generated these yourself. Ensembl also provides ortholog predictions between species, which may allow you to skip step 3.
                                </li>

                                <li>
                                    Extract the coding sequences (CDS) from each genome. This can be done using a tool such as <a href="https://github.com/harvardinformatics/degenotate" target="_blank">degenotate</a>. You will need to extract only a single isoform of each transcript. 
                                    Commonly, the longest one is used.
                                </li>

                                <li>
                                    Predict orthologous gene seqeuences between species. This can be done using a tool such as <a href="https://github.com/olsonanl/FastOrtho" target="_blank">FastOrtho</a>, which is a standalone re-implementation of 
                                    <a href="https://orthomcl.org/orthomcl/app" target="_blank">OrthoMCL</a>. Note that there are many other tools available for predicting orthologs. These programs will output a file containing the orthologous gene sequences for each species,
                                    you will need to use this output to extract the sequences from each species into separate FASTA files, one file per gene. You will also need to decide whether you want to predict your species tree from only single-copy orthologs 
                                    (one sequence per species) or from all gene families.
                                </li>

                                <li>
                                    Align the orthologous coding sequences.
                                </li>




                            </ol>

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>


            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Species tree branch lengths</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>


            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Starting from: HAL</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Starting from: MAF</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Predicting conserved elements</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Starting from: individual locus alignments</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Running the PhyloAcc interface</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Running PhyloAcc</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

            <a class="internal-link" name="inputs"></a>
            <div class="row" id="section-header-cont">
                <div class="col-24-24" id="section-header-row">
                    <div id="section-header">Processing PhyloAcc output</div>
                </div>
            </div>

            <div class="row" id="section-cont">
                <div class="col-24-24" id="section-col">
                    <div class="row" id="section-row">
                        <div class="col-2-24" id="inner-margin"></div>
                        <div class="col-20-24" id="section-content">
     

                        </div>
                        <div class="col-2-24" id="inner-margin"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="row" id="footer">
    <div class="col-1">
        <div id="footer_text">
            <center>Site designed and maintained by <a href="https://gwct.github.io" target="_blank">Gregg Thomas</a> | Page built: 04/07/2023 12:44:31 Eastern Daylight Time</center>
        </div>
    </div>
</div>
</body>
